events {}

http {
    # 127.0.0.11 is the magic IP for Docker's internal DNS server
    resolver 127.0.0.11 valid=5s;

    server {
        listen 80;

        location / {
            # Using a variable forces Nginx to re-resolve the name 'backend' 
            # every time (respecting the 5s valid time)
            set $upstream http://backend:5000;
            proxy_pass $upstream;
        }
    }
}